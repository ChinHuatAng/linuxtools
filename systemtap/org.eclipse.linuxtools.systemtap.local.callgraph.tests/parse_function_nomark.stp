global serial
global startTime
global finalTime

probe process(@1).function("*"){
	callFunction(probefunc())
}

probe process(@1).function("*").return{
	returnFunction(probefunc())
}

probe begin {
	printf("PROBE_BEGIN\n");
	printf("testing\n");
}

function callFunction(probefunc) {
	if (startTime == 0) {
		startTime = gettimeofday_ns()
		printf("<%s,,%d,,%d;", probefunc, serial, startTime)
	} else
	    printf("<%s,,%d,,%d;", probefunc, serial, gettimeofday_ns())
	serial++
}


function returnFunction(probefunc) {
	finalTime = gettimeofday_ns()
	printf(">%s,,%d;", probefunc, finalTime)
}

probe syscall.exit {
	if (pid() == target()) {
		finalTime = gettimeofday_ns()
	}
}

probe end {
	printf("\n%d",finalTime);
	printf("\n%d",finalTime - startTime);
    exit()
}